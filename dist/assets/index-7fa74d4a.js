import{u as I,a as R,g as V,h as L,A as T,p as q,q as M,v as A,a1 as K,w as W,x as $,r as j,i as G,a3 as J,X as Y,j as a,C as z,n as H,o as O,s as X,b as r,L as o,I as c,t as d,an as u,B as P,c as S,Y as Z,Z as Q,T as ee,ao as ae}from"./index-4ff297c6.js";import{T as le}from"./TabContent-c1d86848.js";import{B as se}from"./Breadcrumb-95061577.js";const U=[{link:"/",label:"Beranda"},{link:"/user-management/tabel-user",label:"User Management"},{link:"/",label:"Edit User Management"}],h=new ee;function oe(){var v,N,g,b,_,k,y,C,B,w;document.title="User Management | AHU RI";const f=I(),E=R(),{id:p}=V(),{list_dropdown_roles:x}=L(l=>l.Usman),e=T({initialValues:{fullname:"",username:"",list_roles:[{jenis_role:""}],email:"",nik:"",nip:"",no_kitas_paspor:"",no_telp:"",nib:"",npwp:"",r_roles_code:"",deleted:"",valid:""},validationSchema:q({fullname:M().required("Wajib diisi"),username:M().required("Wajib diisi")}),onSubmit:async l=>{if(!await h.confirmSubmit("Apakah anda yakin ingin mengubah data?","Saya Yakin"))return;let s={id:p,fullname:l==null?void 0:l.fullname,username:l==null?void 0:l.username,email:l==null?void 0:l.email,nik:l.nik,nip:l.nip,no_kitas_paspor:l.no_kitas_paspor,no_telp:l.no_telp,nib:l.nib,npwp:l.npwp,deleted:0,valid:l.valid};l.list_roles.forEach((t,m)=>{var i;s[`r_roles_code[${m}]`]=((i=t.jenis_role)==null?void 0:i.code)||""});try{h.showLoading(),await A(K(s)),W("Data Berhasil Terupdate"),E("/user-management/tabel-user")}catch(t){$(t)}finally{h.close()}}});j.useEffect(()=>{f(G(U)),f(J()),f(Y())},[]),j.useEffect(()=>{p&&(async()=>{var n;try{h.showLoading();const{data:s}=await ae({id:p}),t=Array.from(new Map((n=s.roles)==null?void 0:n.map(i=>[i.code,i])).values()),m=t.map(i=>({jenis_role:{code:i.role_code,title:i.role}}));console.log("uniqueRoles ",t),e.setValues(i=>({...i,fullname:s.fullname,username:s.username,list_roles:m.length>0?m:[{jenis_role:""}],email:s.email,nik:s.nik,nip:s.nip,no_kitas_paspor:s.no_kitas_paspor,no_telp:s.no_telp,nib:s.nib,npwp:s.npwp,valid:s.valid}))}catch(s){$(s)}finally{h.close()}})()},[p]);const D=j.useMemo(()=>{var l;return Array.from(new Map((l=x==null?void 0:x.data)==null?void 0:l.map(n=>[n.code,n])).values())},[x]);return a.jsxs(z,{fluid:!0,className:"page-content",children:[a.jsx(se,{content:U,title:"Ubah User Management"}),a.jsx(H,{children:a.jsx(O,{className:"p-5",children:a.jsx("div",{className:"wizard clearfix",children:a.jsx("div",{className:"content clearfix",children:a.jsx(le,{className:"body pt-0",children:a.jsxs(X,{className:"needs-validation mt-0",children:[a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"Nama Lengkap"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"fullname",placeholder:"Nama Lengkap",type:"text",id:"validation1",onChange:e.handleChange,onBlur:e.handleBlur,value:((v=e.values)==null?void 0:v.fullname)||"",className:`form-control ${e.touched.fullname&&e.errors.fullname?"is-invalid":""}`}),e.touched.fullname&&e.errors.fullname?a.jsx(d,{type:"invalid",children:e.errors.fullname}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"Email"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"email",placeholder:"Email",type:"text",id:"validation1",onChange:e.handleChange,onBlur:e.handleBlur,value:((N=e.values)==null?void 0:N.email)||"",className:`form-control ${e.touched.email&&e.errors.email?"is-invalid":""}`}),e.touched.email&&e.errors.email?a.jsx(d,{type:"invalid",children:e.errors.email}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"NIK"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"nik",placeholder:"Masukkan NIK",type:"text",id:"validation1",onChange:l=>{(u(l.target.value)&&l.target.value.length<=16||l.target.value==="")&&e.handleChange(l)},onBlur:e.handleBlur,value:((g=e.values)==null?void 0:g.nik)||"",className:`form-control ${e.touched.nik&&e.errors.nik?"is-invalid":""}`}),e.touched.nik&&e.errors.nik?a.jsx(d,{type:"invalid",children:e.errors.nik}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"NIP"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"nip",placeholder:"Masukkan NIP",type:"text",id:"validation1",onChange:l=>{(u(l.target.value)||l.target.value==="")&&e.handleChange(l)},onBlur:e.handleBlur,value:((b=e.values)==null?void 0:b.nip)||"",className:`form-control ${e.touched.nip&&e.errors.nip?"is-invalid":""}`}),e.touched.nip&&e.errors.nip?a.jsx(d,{type:"invalid",children:e.errors.nip}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"No. Kitas Pasport"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"no_kitas_paspor",placeholder:"Masukkan No. Kitas Pasport",type:"text",id:"validation1",onChange:l=>{(u(l.target.value)||l.target.value==="")&&e.handleChange(l)},onBlur:e.handleBlur,value:((_=e.values)==null?void 0:_.no_kitas_paspor)||"",className:`form-control ${e.touched.no_kitas_paspor&&e.errors.no_kitas_paspor?"is-invalid":""}`}),e.touched.no_kitas_paspor&&e.errors.no_kitas_paspor?a.jsx(d,{type:"invalid",children:e.errors.no_kitas_paspor}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"No. Telp"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"no_telp",placeholder:"Masukkan No. Telp",type:"text",id:"validation1",onChange:l=>{(u(l.target.value)||l.target.value==="")&&e.handleChange(l)},onBlur:e.handleBlur,value:((k=e.values)==null?void 0:k.no_telp)||"",className:`form-control ${e.touched.no_telp&&e.errors.no_telp?"is-invalid":""}`}),e.touched.no_telp&&e.errors.no_telp?a.jsx(d,{type:"invalid",children:e.errors.no_telp}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"NIB"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"nib",placeholder:"Masukkan NIB",type:"text",id:"validation1",onChange:l=>{(u(l.target.value)&&l.target.value.length<=13||l.target.value==="")&&e.handleChange(l)},onBlur:e.handleBlur,value:((y=e.values)==null?void 0:y.nib)||"",className:`form-control ${e.touched.nib&&e.errors.nib?"is-invalid":""}`}),e.touched.nib&&e.errors.nib?a.jsx(d,{type:"invalid",children:e.errors.nib}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"NPWP"}),a.jsx("div",{className:"col-md-10",children:a.jsxs("div",{className:"d-flex flex-column align-items-start",children:[a.jsx(c,{name:"npwp",placeholder:"Masukkan NPWP",type:"text",id:"validation1",onChange:l=>{(u(l.target.value)||l.target.value==="")&&e.handleChange(l)},onBlur:e.handleBlur,value:((C=e.values)==null?void 0:C.npwp)||"",className:`form-control ${e.touched.npwp&&e.errors.npwp?"is-invalid":""}`}),e.touched.npwp&&e.errors.npwp?a.jsx(d,{type:"invalid",children:e.errors.npwp}):null]})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(o,{htmlFor:"validationCustom03",className:"col-md-2 col-form-label",children:"Username"}),a.jsx("div",{className:"col-md-10",children:a.jsx(c,{disabled:!0,name:"username",placeholder:"Username",value:((B=e.values)==null?void 0:B.username)||"",className:"select2-selection"})})]}),a.jsx(r,{className:"mb-3",children:a.jsx("div",{children:((w=e==null?void 0:e.values)==null?void 0:w.list_roles).map((l,n)=>a.jsxs(r,{className:"bg-secondary bg-opacity-10 p-4 rounded mb-3",style:{rowGap:".5rem"},children:[a.jsxs("div",{className:"d-flex justify-content-end mb-3",children:[a.jsx(P,{type:"button",color:"success",className:"btn-sm rounded me-2",onClick:()=>e.setFieldValue("list_roles",[...e.values.list_roles,{jenis_role:""}]),children:a.jsx("i",{className:"bx bx-plus fs-5"})}),n>0&&a.jsx(P,{type:"button",color:"danger",className:"btn-sm rounded",onClick:()=>e.setFieldValue("list_roles",e.values.list_roles.filter((s,t)=>t!==n)),children:a.jsx("i",{className:"bx bx-trash-alt fs-5"})})]}),a.jsxs(r,{className:"mb-3",children:[a.jsx(S,{md:2,children:a.jsx(o,{htmlFor:"validationCustom01",className:"col-form-label pb-0",children:"Jenis Role"})}),a.jsx(S,{md:10,children:a.jsx(Z,{value:l.jenis_role||null,getOptionValue:s=>s.code,getOptionLabel:s=>s.title,onChange:s=>{var m;((m=e.values.list_roles)==null?void 0:m.find(i=>{var F;return((F=i.jenis_role)==null?void 0:F.code)==s.code}))?e.setFieldValue(`list_roles.${n}.jenis_role`,null):e.setFieldValue(`list_roles.${n}.jenis_role`,s)},options:D,styles:Q,id:`list_roles.${n}.jenis_role`,name:`list_roles.${n}.jenis_role`,placeholder:"Pilih Jenis Role"})})]})]},n))})}),a.jsx("div",{className:"actions clearfix justify-content-end d-flex",children:a.jsx("button",{type:"submit",onClick:l=>{l.preventDefault(),e.handleSubmit()},className:"btn btn-primary",children:"Simpan"})})]})})})})})})]})}export{oe as default};
